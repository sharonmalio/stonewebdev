


<div id="mapid"></div>

<div id="main"></div>
       

 <script>

 $( document ).ready(function() {
		var tiles = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png?v=29&x={x}&y={y}&z={z}&language=en_GB?access_token={pk.eyJ1Ijoia2FuaW5pbWFsaW8iLCJhIjoiY2poamh4ZjllMDB4ZTM2cWtoM2V3bWd1ZyJ9.rnF81uaCjIFtaEAfQ1ytBg}', {
         attribution: 'Map data © <a href="https://www.openstreetmap.org/">KenyaHealthFacilitiess</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
         maxZoom: 18,
         id: 'mapbox.streets',
         accessToken: 'pk.eyJ1Ijoia2FuaW5pbWFsaW8iLCJhIjoiY2poamh4ZjllMDB4ZTM2cWtoM2V3bWd1ZyJ9.rnF81uaCjIFtaEAfQ1ytBg'
     });
	    var mymap = L.map('mapid', {center: [3.121832846, 35.587164318], zoom:9, layers: tiles});

     var markers = [
     	<?php foreach ($hospitals as $stonelink) : ?>
     	[<?= $this->escapeHtml($stonelink->latitude)?>,  <?= $this->escapeHtml($stonelink->longitude)?>, "<?= $this->escapeHtml($stonelink->facility_n)?>"],
     	<?php endforeach; ?>
     			];

     var markerClusterGroup = L.markerClusterGroup();

     for (var i = 0; i < markers.length; i++) {
     	var a = markers[i];
     	var title = a[2];
     	var marker = L.marker(new L.LatLng(a[0], a[1]), { title: title });
     	marker.bindPopup(title);
     	markerClusterGroup.addLayer(marker);
     }

     mymap.addLayer(markerClusterGroup);
	    var popup = L.popup();
	    function onMapClick(e) {
	        popup
	            .setLatLng(e.latlng)
	            .setContent("You clicked the map at " + e.latlng.toString())
	            .openOn(mymap);
	    }
	    mymap.on('click', onMapClick);
	});
  




 </script>